{
    "info": {
        "_postman_id": "catalog-service-001",
        "name": "Catalog Service API",
        "description": "API collection for Catalog Service with JWT authentication, S3 image upload, and multi-tenant access control\n\n## Tenant Handling (IMPORTANT)\n\n### For MANAGERS:\n- tenantId is automatically extracted from JWT token\n- DO NOT include \"tenantId\" in request body when creating/updating products/toppings\n- Managers can only access resources from their own tenant\n\n### For ADMINS:\n- MUST provide \"tenantId\" in request body when creating products/toppings\n- Can access and manage resources from any tenant\n- Can change tenantId when updating resources\n\n### Usage:\n1. Login as Admin or Manager to get JWT token\n2. Token is stored automatically in environment variable\n3. Use appropriate request body based on your role",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
        "_exporter_id": "12345"
    },
    "item": [
        {
            "name": "Auth",
            "item": [
                {
                    "name": "Login (Admin)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    const jsonData = pm.response.json();",
                                    "    ",
                                    "    if (jsonData.accessToken) {",
                                    "        pm.environment.set(\"access_token\", jsonData.accessToken);",
                                    "        console.log(\"Access token saved to environment\");",
                                    "    }",
                                    "    ",
                                    "    if (jsonData.refreshToken) {",
                                    "        pm.environment.set(\"refresh_token\", jsonData.refreshToken);",
                                    "        console.log(\"Refresh token saved to environment\");",
                                    "    }",
                                    "    ",
                                    "    const cookies = pm.cookies.all();",
                                    "    console.log(\"Cookies received:\", cookies);",
                                    "    ",
                                    "    pm.test(\"Login successful\", function () {",
                                    "        pm.response.to.have.status(200);",
                                    "    });",
                                    "    ",
                                    "    pm.test(\"User ID returned\", function () {",
                                    "        pm.expect(jsonData).to.have.property('id');",
                                    "    });",
                                    "} else {",
                                    "    pm.test(\"Login failed with status: \" + pm.response.code, function () {",
                                    "        pm.expect.fail(\"Login request failed\");",
                                    "    });",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"email\": \"{{admin_email}}\",\n    \"password\": \"{{admin_password}}\"\n}"
                        },
                        "url": {
                            "raw": "{{auth_service_url}}/auth/login",
                            "host": ["{{auth_service_url}}"],
                            "path": ["auth", "login"]
                        },
                        "description": "Login with admin credentials. Admin has full access to all tenants."
                    },
                    "response": []
                },
                {
                    "name": "Login (Manager)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    const jsonData = pm.response.json();",
                                    "    ",
                                    "    if (jsonData.accessToken) {",
                                    "        pm.environment.set(\"access_token\", jsonData.accessToken);",
                                    "        console.log(\"Access token saved to environment\");",
                                    "    }",
                                    "    ",
                                    "    if (jsonData.refreshToken) {",
                                    "        pm.environment.set(\"refresh_token\", jsonData.refreshToken);",
                                    "        console.log(\"Refresh token saved to environment\");",
                                    "    }",
                                    "    ",
                                    "    const cookies = pm.cookies.all();",
                                    "    console.log(\"Cookies received:\", cookies);",
                                    "    ",
                                    "    pm.test(\"Login successful\", function () {",
                                    "        pm.response.to.have.status(200);",
                                    "    });",
                                    "    ",
                                    "    pm.test(\"User ID returned\", function () {",
                                    "        pm.expect(jsonData).to.have.property('id');",
                                    "    });",
                                    "} else {",
                                    "    pm.test(\"Login failed with status: \" + pm.response.code, function () {",
                                    "        pm.expect.fail(\"Login request failed\");",
                                    "    });",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"email\": \"{{manager_email}}\",\n    \"password\": \"{{manager_password}}\"\n}"
                        },
                        "url": {
                            "raw": "{{auth_service_url}}/auth/login",
                            "host": ["{{auth_service_url}}"],
                            "path": ["auth", "login"]
                        },
                        "description": "Login with manager credentials. Manager can only manage products from their own tenant."
                    },
                    "response": []
                }
            ],
            "description": "Authentication endpoints from Auth Service"
        },
        {
            "name": "Categories",
            "item": [
                {
                    "name": "Get All Categories",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "pm.test(\"Response contains categories array\", function () {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.have.property('categories');",
                                    "    pm.expect(jsonData.categories).to.be.an('array');",
                                    "    ",
                                    "    if (jsonData.categories.length > 0) {",
                                    "        pm.environment.set(\"category_id\", jsonData.categories[0]._id);",
                                    "    }",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{catalog_service_url}}/categories",
                            "host": ["{{catalog_service_url}}"],
                            "path": ["categories"]
                        },
                        "description": "Fetch all categories (No authentication required)"
                    },
                    "response": []
                },
                {
                    "name": "Get Category by ID",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "pm.test(\"Response contains category\", function () {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.have.property('category');",
                                    "    pm.expect(jsonData.category).to.have.property('_id');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{catalog_service_url}}/categories/{{category_id}}",
                            "host": ["{{catalog_service_url}}"],
                            "path": ["categories", "{{category_id}}"]
                        },
                        "description": "Fetch a specific category by ID"
                    },
                    "response": []
                },
                {
                    "name": "Create Category",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Category created successfully\", function () {",
                                    "    pm.response.to.have.status(201);",
                                    "});",
                                    "",
                                    "pm.test(\"Response contains category data\", function () {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.have.property('message');",
                                    "    pm.expect(jsonData).to.have.property('category');",
                                    "    ",
                                    "    if (jsonData.category && jsonData.category._id) {",
                                    "        pm.environment.set(\"category_id\", jsonData.category._id);",
                                    "        console.log(\"Category ID saved:\", jsonData.category._id);",
                                    "    }",
                                    "});",
                                    "",
                                    "pm.test(\"Category has required fields\", function () {",
                                    "    const category = pm.response.json().category;",
                                    "    pm.expect(category).to.have.property('_id');",
                                    "    pm.expect(category).to.have.property('name');",
                                    "    pm.expect(category).to.have.property('priceCofigration');",
                                    "    pm.expect(category).to.have.property('attributes');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [
                                {
                                    "key": "token",
                                    "value": "{{access_token}}",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"name\": \"Pizza\",\n    \"priceCofigration\": {\n        \"size\": {\n            \"priceType\": \"base\",\n            \"availableOptions\": [\"small\", \"medium\", \"large\"]\n        },\n        \"toppings\": {\n            \"priceType\": \"additional\",\n            \"availableOptions\": [\"cheese\", \"pepperoni\", \"mushrooms\"]\n        }\n    },\n    \"attributes\": [\n        {\n            \"name\": \"Crust\",\n            \"wigetType\": \"radio\",\n            \"defaultValue\": \"thin\",\n            \"availableOptions\": [\"thin\", \"thick\", \"stuffed\"]\n        }\n    ]\n}\n\n// NOTE FOR ADMINS: Add this line at the end before closing brace\n// \"tenantId\": \"{{tenant_id}}\",\n\n// NOTE FOR MANAGERS: Do NOT include tenantId - it comes from your JWT token automatically"
                        },
                        "url": {
                            "raw": "{{catalog_service_url}}/categories",
                            "host": ["{{catalog_service_url}}"],
                            "path": ["categories"]
                        },
                        "description": "Create a new category (Requires ADMIN or MANAGER authentication)\n\nNote: \n- ADMIN: Can create categories for any tenant (must provide tenantId in body)\n- MANAGER: Can only create categories for their own tenant (tenantId automatically from token, remove from body if manager)\n\nFor MANAGER: Remove \"tenantId\" field from the request body\nFor ADMIN: Keep \"tenantId\" field and specify the target tenant"
                    },
                    "response": []
                },
                {
                    "name": "Update Category",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Category updated successfully\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "pm.test(\"Response contains updated category\", function () {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.have.property('category');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [
                                {
                                    "key": "token",
                                    "value": "{{access_token}}",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"name\": \"Updated Pizza Category\",\n    \"priceCofigration\": {\n        \"size\": {\n            \"priceType\": \"base\",\n            \"availableOptions\": [\"small\", \"large\", \"extra-large\"]\n        }\n    }\n}"
                        },
                        "url": {
                            "raw": "{{catalog_service_url}}/categories/{{category_id}}",
                            "host": ["{{catalog_service_url}}"],
                            "path": ["categories", "{{category_id}}"]
                        },
                        "description": "Update an existing category (Requires ADMIN or MANAGER authentication)"
                    },
                    "response": []
                },
                {
                    "name": "Delete Category",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Category deleted successfully\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "pm.test(\"Response contains deleted category\", function () {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.have.property('message');",
                                    "    pm.expect(jsonData).to.have.property('category');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [
                                {
                                    "key": "token",
                                    "value": "{{access_token}}",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "DELETE",
                        "header": [],
                        "url": {
                            "raw": "{{catalog_service_url}}/categories/{{category_id}}",
                            "host": ["{{catalog_service_url}}"],
                            "path": ["categories", "{{category_id}}"]
                        },
                        "description": "Delete a category (Requires ADMIN or MANAGER authentication)"
                    },
                    "response": []
                }
            ],
            "description": "Category CRUD operations"
        },
        {
            "name": "Products",
            "item": [
                {
                    "name": "Get All Products",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "pm.test(\"Response contains products array\", function () {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.have.property('products');",
                                    "    pm.expect(jsonData.products).to.be.an('array');",
                                    "    ",
                                    "    if (jsonData.products.length > 0) {",
                                    "        pm.environment.set(\"product_id\", jsonData.products[0]._id);",
                                    "    }",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{catalog_service_url}}/products",
                            "host": ["{{catalog_service_url}}"],
                            "path": ["products"]
                        },
                        "description": "Fetch all products (No authentication required)"
                    },
                    "response": []
                },
                {
                    "name": "Get Product by ID",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "pm.test(\"Response contains product\", function () {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.have.property('product');",
                                    "    pm.expect(jsonData.product).to.have.property('_id');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{catalog_service_url}}/products/{{product_id}}",
                            "host": ["{{catalog_service_url}}"],
                            "path": ["products", "{{product_id}}"]
                        },
                        "description": "Fetch a specific product by ID with populated category"
                    },
                    "response": []
                },
                {
                    "name": "Upload Product Image",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Image uploaded successfully\", function () {",
                                    "    pm.response.to.have.status(201);",
                                    "});",
                                    "",
                                    "pm.test(\"Response contains S3 URL and key\", function () {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.have.property('data');",
                                    "    pm.expect(jsonData.data).to.have.property('url');",
                                    "    pm.expect(jsonData.data).to.have.property('key');",
                                    "    ",
                                    "    if (jsonData.data.url) {",
                                    "        pm.environment.set(\"product_image_url\", jsonData.data.url);",
                                    "        console.log(\"Image URL saved:\", jsonData.data.url);",
                                    "    }",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [
                                {
                                    "key": "token",
                                    "value": "{{access_token}}",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [],
                        "body": {
                            "mode": "formdata",
                            "formdata": [
                                {
                                    "key": "image",
                                    "type": "file",
                                    "src": []
                                }
                            ]
                        },
                        "url": {
                            "raw": "{{catalog_service_url}}/products/upload-image",
                            "host": ["{{catalog_service_url}}"],
                            "path": ["products", "upload-image"]
                        },
                        "description": "Upload product image to AWS S3 (Requires ADMIN or MANAGER authentication)\n\nReturns S3 URL and key for the uploaded image.\n\nSupported formats: JPEG, JPG, PNG, WEBP, GIF\nMax size: 5MB"
                    },
                    "response": []
                },
                {
                    "name": "Create Product",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Product created successfully\", function () {",
                                    "    pm.response.to.have.status(201);",
                                    "});",
                                    "",
                                    "pm.test(\"Response contains product data\", function () {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.have.property('message');",
                                    "    pm.expect(jsonData).to.have.property('product');",
                                    "    ",
                                    "    if (jsonData.product && jsonData.product._id) {",
                                    "        pm.environment.set(\"product_id\", jsonData.product._id);",
                                    "        console.log(\"Product ID saved:\", jsonData.product._id);",
                                    "    }",
                                    "});",
                                    "",
                                    "pm.test(\"Product has required fields\", function () {",
                                    "    const product = pm.response.json().product;",
                                    "    pm.expect(product).to.have.property('_id');",
                                    "    pm.expect(product).to.have.property('name');",
                                    "    pm.expect(product).to.have.property('image');",
                                    "    pm.expect(product).to.have.property('category');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [
                                {
                                    "key": "token",
                                    "value": "{{access_token}}",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"name\": \"Margherita Pizza\",\n    \"description\": \"Classic pizza with tomato sauce, mozzarella, and basil\",\n    \"image\": \"{{product_image_url}}\",\n    \"category\": \"{{category_id}}\",\n    \"priceConfiguration\": {\n        \"small\": {\n            \"priceType\": \"base\",\n            \"availableOptions\": {\n                \"small\": 10,\n                \"medium\": 15,\n                \"large\": 20\n            }\n        }\n    },\n    \"attributes\": [\n        {\n            \"name\": \"Size\",\n            \"value\": \"medium\"\n        }\n    ],\n    \"isPublished\": true\n}\n\n// NOTE FOR ADMINS: Add this line above isPublished\n// \"tenantId\": \"{{tenant_id}}\",\n\n// NOTE FOR MANAGERS: Do NOT include tenantId - it comes from your JWT token automatically"
                        },
                        "url": {
                            "raw": "{{catalog_service_url}}/products",
                            "host": ["{{catalog_service_url}}"],
                            "path": ["products"]
                        },
                        "description": "Create a new product with S3 image URL (Requires ADMIN or MANAGER authentication)\n\nNote: \n- Upload image first using 'Upload Product Image' endpoint\n- ADMIN: Can create products for any tenant (must provide tenantId in body)\n- MANAGER: Can only create products for their own tenant (tenantId automatically from token, remove from body if manager)\n\nFor MANAGER: Remove \"tenantId\" field from the request body\nFor ADMIN: Keep \"tenantId\" field and specify the target tenant"
                    },
                    "response": []
                },
                {
                    "name": "Update Product",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Product updated successfully\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "pm.test(\"Response contains updated product\", function () {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.have.property('product');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [
                                {
                                    "key": "token",
                                    "value": "{{access_token}}",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"name\": \"Updated Margherita Pizza\",\n    \"description\": \"Updated description for the pizza\",\n    \"image\": \"{{product_image_url}}\",\n    \"isPublished\": false\n}"
                        },
                        "url": {
                            "raw": "{{catalog_service_url}}/products/{{product_id}}",
                            "host": ["{{catalog_service_url}}"],
                            "path": ["products", "{{product_id}}"]
                        },
                        "description": "Update an existing product (Requires ADMIN or MANAGER authentication)\n\nNote:\n- ADMIN: Can update any product from any tenant (can change tenantId if needed)\n- MANAGER: Can only update products from their own tenant (cannot change tenantId)\n- Image can be updated - old image will be deleted from S3 automatically\n- For MANAGER: tenantId in request body is ignored (tenant cannot be changed)"
                    },
                    "response": []
                },
                {
                    "name": "Delete Product",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Product deleted successfully\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "pm.test(\"Response contains deleted product\", function () {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.have.property('message');",
                                    "    pm.expect(jsonData).to.have.property('product');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [
                                {
                                    "key": "token",
                                    "value": "{{access_token}}",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "DELETE",
                        "header": [],
                        "url": {
                            "raw": "{{catalog_service_url}}/products/{{product_id}}",
                            "host": ["{{catalog_service_url}}"],
                            "path": ["products", "{{product_id}}"]
                        },
                        "description": "Delete a product (Requires ADMIN or MANAGER authentication)\n\nNote:\n- ADMIN: Can delete any product from any tenant\n- MANAGER: Can only delete products from their own tenant\n- Product image will be automatically deleted from S3"
                    },
                    "response": []
                }
            ],
            "description": "Product CRUD operations with S3 image upload and multi-tenant access control"
        },
        {
            "name": "Toppings",
            "item": [
                {
                    "name": "Get All Toppings",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "pm.test(\"Response contains toppings array\", function () {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.have.property('data');",
                                    "    pm.expect(jsonData.data).to.be.an('array');",
                                    "    ",
                                    "    if (jsonData.data.length > 0) {",
                                    "        pm.environment.set(\"topping_id\", jsonData.data[0]._id);",
                                    "    }",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{catalog_service_url}}/toppings?page=1&limit=10",
                            "host": ["{{catalog_service_url}}"],
                            "path": ["toppings"],
                            "query": [
                                {
                                    "key": "page",
                                    "value": "1"
                                },
                                {
                                    "key": "limit",
                                    "value": "10"
                                },
                                {
                                    "key": "q",
                                    "value": "",
                                    "disabled": true
                                },
                                {
                                    "key": "tenantId",
                                    "value": "",
                                    "disabled": true
                                },
                                {
                                    "key": "isPublished",
                                    "value": "true",
                                    "disabled": true
                                }
                            ]
                        },
                        "description": "Fetch all toppings with pagination (No authentication required)\n\nQuery Parameters:\n- page: Page number (default: 1)\n- limit: Items per page (default: 10)\n- q: Search by name\n- tenantId: Filter by tenant\n- isPublished: Filter by published status"
                    },
                    "response": []
                },
                {
                    "name": "Get Topping by ID",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Status code is 200\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "pm.test(\"Response contains topping\", function () {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.have.property('topping');",
                                    "    pm.expect(jsonData.topping).to.have.property('_id');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{catalog_service_url}}/toppings/{{topping_id}}",
                            "host": ["{{catalog_service_url}}"],
                            "path": ["toppings", "{{topping_id}}"]
                        },
                        "description": "Fetch a specific topping by ID"
                    },
                    "response": []
                },
                {
                    "name": "Upload Topping Image",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Image uploaded successfully\", function () {",
                                    "    pm.response.to.have.status(201);",
                                    "});",
                                    "",
                                    "pm.test(\"Response contains S3 URL and key\", function () {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.have.property('data');",
                                    "    pm.expect(jsonData.data).to.have.property('url');",
                                    "    pm.expect(jsonData.data).to.have.property('key');",
                                    "    ",
                                    "    if (jsonData.data.url) {",
                                    "        pm.environment.set(\"topping_image_url\", jsonData.data.url);",
                                    "        console.log(\"Image URL saved:\", jsonData.data.url);",
                                    "    }",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [
                                {
                                    "key": "token",
                                    "value": "{{access_token}}",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [],
                        "body": {
                            "mode": "formdata",
                            "formdata": [
                                {
                                    "key": "image",
                                    "type": "file",
                                    "src": []
                                }
                            ]
                        },
                        "url": {
                            "raw": "{{catalog_service_url}}/toppings/upload-image",
                            "host": ["{{catalog_service_url}}"],
                            "path": ["toppings", "upload-image"]
                        },
                        "description": "Upload topping image to AWS S3 (Requires ADMIN or MANAGER authentication)\n\nReturns S3 URL and key for the uploaded image.\n\nSupported formats: JPEG, JPG, PNG, WEBP, GIF\nMax size: 5MB"
                    },
                    "response": []
                },
                {
                    "name": "Create Topping",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Topping created successfully\", function () {",
                                    "    pm.response.to.have.status(201);",
                                    "});",
                                    "",
                                    "pm.test(\"Response contains topping data\", function () {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.have.property('message');",
                                    "    pm.expect(jsonData).to.have.property('topping');",
                                    "    ",
                                    "    if (jsonData.topping && jsonData.topping._id) {",
                                    "        pm.environment.set(\"topping_id\", jsonData.topping._id);",
                                    "        console.log(\"Topping ID saved:\", jsonData.topping._id);",
                                    "    }",
                                    "});",
                                    "",
                                    "pm.test(\"Topping has required fields\", function () {",
                                    "    const topping = pm.response.json().topping;",
                                    "    pm.expect(topping).to.have.property('_id');",
                                    "    pm.expect(topping).to.have.property('name');",
                                    "    pm.expect(topping).to.have.property('image');",
                                    "    pm.expect(topping).to.have.property('price');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [
                                {
                                    "key": "token",
                                    "value": "{{access_token}}",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"name\": \"Extra Cheese\",\n    \"image\": \"{{topping_image_url}}\",\n    \"price\": 50,\n    \"isPublished\": true\n}\n\n// NOTE FOR ADMINS: Add this line above isPublished\n// \"tenantId\": \"{{tenant_id}}\",\n\n// NOTE FOR MANAGERS: Do NOT include tenantId - it comes from your JWT token automatically"
                        },
                        "url": {
                            "raw": "{{catalog_service_url}}/toppings",
                            "host": ["{{catalog_service_url}}"],
                            "path": ["toppings"]
                        },
                        "description": "Create a new topping with S3 image URL (Requires ADMIN or MANAGER authentication)\n\nNote: \n- Upload image first using 'Upload Topping Image' endpoint\n- ADMIN: Can create toppings for any tenant (must provide tenantId in body)\n- MANAGER: Can only create toppings for their own tenant (tenantId automatically from token, remove from body if manager)\n\nFor MANAGER: Remove \"tenantId\" field from the request body\nFor ADMIN: Keep \"tenantId\" field and specify the target tenant"
                    },
                    "response": []
                },
                {
                    "name": "Update Topping",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Topping updated successfully\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "pm.test(\"Response contains updated topping\", function () {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.have.property('topping');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [
                                {
                                    "key": "token",
                                    "value": "{{access_token}}",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"name\": \"Updated Extra Cheese\",\n    \"price\": 60,\n    \"isPublished\": false\n}"
                        },
                        "url": {
                            "raw": "{{catalog_service_url}}/toppings/{{topping_id}}",
                            "host": ["{{catalog_service_url}}"],
                            "path": ["toppings", "{{topping_id}}"]
                        },
                        "description": "Update an existing topping (Requires ADMIN or MANAGER authentication)\n\nNote:\n- ADMIN: Can update any topping from any tenant (can change tenantId if needed)\n- MANAGER: Can only update toppings from their own tenant (cannot change tenantId)\n- Image can be updated - old image will be deleted from S3 automatically\n- For MANAGER: tenantId in request body is ignored (tenant cannot be changed)"
                    },
                    "response": []
                },
                {
                    "name": "Delete Topping",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test(\"Topping deleted successfully\", function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "pm.test(\"Response contains deleted topping\", function () {",
                                    "    const jsonData = pm.response.json();",
                                    "    pm.expect(jsonData).to.have.property('message');",
                                    "    pm.expect(jsonData).to.have.property('topping');",
                                    "});"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [
                                {
                                    "key": "token",
                                    "value": "{{access_token}}",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "DELETE",
                        "header": [],
                        "url": {
                            "raw": "{{catalog_service_url}}/toppings/{{topping_id}}",
                            "host": ["{{catalog_service_url}}"],
                            "path": ["toppings", "{{topping_id}}"]
                        },
                        "description": "Delete a topping (Requires ADMIN or MANAGER authentication)\n\nNote:\n- ADMIN: Can delete any topping from any tenant\n- MANAGER: Can only delete toppings from their own tenant\n- Topping image will be automatically deleted from S3"
                    },
                    "response": []
                }
            ],
            "description": "Topping CRUD operations with S3 image upload and multi-tenant access control"
        },
        {
            "name": "Health Check",
            "item": [
                {
                    "name": "Catalog Service Health",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{catalog_service_url}}/",
                            "host": ["{{catalog_service_url}}"],
                            "path": [""]
                        },
                        "description": "Check if the Catalog Service is running"
                    },
                    "response": []
                }
            ],
            "description": "Health check endpoints"
        }
    ],
    "auth": {
        "type": "bearer",
        "bearer": [
            {
                "key": "token",
                "value": "{{access_token}}",
                "type": "string"
            }
        ]
    }
}
